<div class="evidence_item">
  <div class="index">{{this.index}}</div>
  <div class="evidence_fields">

    <app-pr-radio-button *ngIf="!this.dataControlSE.isKnowledgeProduct" [options]="this.evidencesType"
      optionLabel="name" optionValue="id" (ngModelChange)="cleanSource($event)" label="Source of the evidence"
      [(ngModel)]="this.evidence.is_sharepoint">
    </app-pr-radio-button>

    <div class="link" *ngIf="!this.evidence.is_sharepoint;else upload_file">
      <app-pr-input label="Link" [(ngModel)]="this.evidence.link" placeholder="Add link" type="link"
        [disabled]="this.dataControlSE.isKnowledgeProduct" [required]="!isOptional"></app-pr-input>
    </div>





    <ng-template #upload_file>

      <app-pr-radio-button [options]="this.isPubilcFileOptions" optionLabel="name" optionValue="id"
        label="Is this a pubilc file?" [(ngModel)]="this.evidence.is_public_file">
      </app-pr-radio-button>

      <app-alert-status [description]="this.publicFileDesc">
      </app-alert-status>

      <app-pr-field-header label="File to be uploaded on the repository"></app-pr-field-header>
      <app-alert-status
        description="This repository will be managed through SharePoint in the: “One CGIAR – PRMS Repository“. The documents within it will be view-only and can not be edited. Also the access will be limited to CGIAR accounts.">
      </app-alert-status>


      <div class="file-link-view" *ngIf="this.evidence?.sp_file_name;else uploadfilefield">
        <div class="file-name">
          <i class="material-icons-round">
            description
          </i>
          <a *ngIf="this.evidence.link else nolinktext" [href]="this.evidence.link" target="_blank"
            rel="noopener noreferrer">{{this.evidence?.sp_file_name}}</a>
          <ng-template #nolinktext>You are going to save the file:
            <strong>{{this.evidence?.sp_file_name}}</strong></ng-template>
        </div>
        <div class="file-actions">

          <div class="size" *ngIf="!this.evidence?.link">
            {{(this.evidence?.file.size / 1048576) | number:'1.2-2' }} MB
          </div>

          <div class="line">

          </div>

          <div class="percentage" pTooltip="Uploading"
            *ngIf="this.evidence?.percentage !== 100 && !this.evidence.link; else fileloaded">
            {{this.evidence?.percentage}} <div *ngIf="this.evidence?.percentage">%</div>
          </div>
          <ng-template #fileloaded>
            <i class="material-icons-round" pTooltip="Uploaded" style="margin-right: 5px;" (click)="onDeleteSPLink()">
              check_circle
            </i>
          </ng-template>
          <i class="material-icons-round" style="cursor: pointer" (click)="onDeleteSPLink()">
            delete
          </i>
        </div>
        <div class="floating-line-animated" [style.width.%]="this.evidence?.percentage"></div>

      </div>

      <ng-template #uploadfilefield>
        <div *ngIf="this.evidence.is_public_file == true || this.evidence.is_public_file == false"
          class="drag-and-drop-field" [ngClass]="{'incorrect-drag-and-drop-field': this.incorrectFile}"
          (drop)="onFileDropped($event)" (dragover)="onDragOver($event)" (dragleave)="onDragLeave($event)">
          <div class="content">
            <img src="assets/icons/feather_upload-cloud.svg" alt="" srcset="">
            <div class="title">Select a file or drag and drop here</div>
            <div class="description">jpg, png, doc, xlsx or PDF, file size no more than 1GB</div>
            <app-pr-button text="Select file" (click)="fileInput.click()"></app-pr-button>
          </div>
        </div>
        <input class="inputfieldHidden" #fileInput type="file" (change)="onFileSelected($event)"
          accept=".jpg, .png, .pdf, .doc, .pptx, .xlsx" multiple="false">
        <div class="incorrect-file" *ngIf="this.incorrectFile">Incorrect format only files supported: .jpg,
          .png, .pdf, .doc, .pptx, .xlsx</div>
      </ng-template>

    </ng-template>

    <app-pr-field-header label="Please indicate for which Impact Area tags this evidence is related to"
      [required]="false" *ngIf="!isSuppInfo"></app-pr-field-header>
    <div class="checkboxes" *ngIf="!isSuppInfo">
      <app-pr-checkbox label="Gender" [(ngModel)]="this.evidence.gender_related">
      </app-pr-checkbox>
      <app-pr-checkbox label="Climate change" [(ngModel)]="this.evidence.youth_related">
      </app-pr-checkbox>
      <app-pr-checkbox label="Nutrition" [(ngModel)]="this.evidence.nutrition_related">
      </app-pr-checkbox>
      <app-pr-checkbox label="Environment" [(ngModel)]="this.evidence.environmental_biodiversity_related">
      </app-pr-checkbox>
      <app-pr-checkbox label="Poverty" [(ngModel)]="this.evidence.poverty_related">
      </app-pr-checkbox>
    </div>
    <app-pr-textarea
      [label]="'Please provide details of where' + (isSuppInfo ? ' supplementary information ' :' evidence ') +'can be found within the source link (e.g. page number, slide number, table number)'"
      [required]="false" [(ngModel)]="this.evidence.description" [maxWords]="50" placeholder="Add description">
    </app-pr-textarea>
  </div>
  <app-edit-or-delete-item-button (click)="this.deleteItem()"
    *ngIf="!this.dataControlSE.isKnowledgeProduct  && !this.api.rolesSE.readOnly && !this.api.dataControlSE?.currentResult?.status">
  </app-edit-or-delete-item-button>

</div>