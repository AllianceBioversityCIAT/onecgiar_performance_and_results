<br>
<div class="target">
    <div class="header-target">
        <div class="subheader">
            <div>
                <h4>Indicator statement: <span style=" font-weight: normal;">{{initiative.statement}}</span></h4>
            </div>
        </div>
    </div>

    <div class="indicator-info">
        <div class="title">
            <div class="square"></div>
            <strong>Indicator info</strong>
        </div>
        <div class="indicator">

            <div class="one-description">
                <div class="indicator-item ">
                    <strong>Source:</strong>
                    <span *ngIf="initiative.type_value != 'custom'">PRMF Framework</span><span
                        *ngIf="initiative.type_value == 'custom'">Custom</span>
                </div>
                <div class="indicator-item">
                    <strong>Type:</strong>
                    <div>{{initiative.type}}</div>
                </div>
            </div>
            <div class="indicator-item">
                <strong>Description:</strong>{{initiative.indicator_description}}
            </div>

            <div class="indicator-item">
                <strong>Location:</strong>
                <span>{{initiative.location}}</span> <span *ngIf="initiative.full_geo != ''">(<span
                        *ngIf="initiative.full_geo != ':null'">{{initiative.full_geo}}</span>)</span>
            </div>
            <div style="margin-left: -20px;margin-top: -5px;">
                <app-alert-status [description]="descriptionAlert()"></app-alert-status>
            </div>
        </div>
    </div>
    <div class="line"></div>

    <div *ngIf="initiative.targets.length == 0">
        <app-alert-status [description]="'There are no targets for this indicator.'"
            status="warning"></app-alert-status>
    </div>

    <div class="messurement" *ngIf="initiative.targets.length">
        <div class="title-mesuren">
            <div class="square-messerunet"></div>
            <div style="margin-top: -15px;">
                <h4>Measurement</h4>
            </div>
        </div>
        <div *ngFor="let item of initiative.targets" >
            <div appFeedbackValidation labelText="Contribution to an indicator's target is missing"
            [isComplete]="!checkAlert()"></div>
        
            <div class="content-number" *ngIf="initiative.is_calculable; else contentNotNumber">
                <div class="section-one">
                    <div class="info-messurent">
                        <div class="info-messurent-item target-number">
                            <strong>Target #{{sumIndicator(item.number_target)}}</strong>
                        </div>
                        <div class="info-messurent-item unit-messurent">
                            <strong>Unit of measure:</strong>{{initiative.unit_messurament}}
                        </div>
                        <div class="info-messurent-item overall-target">
                            <strong>Overall target:</strong>{{item.target_value}}
                        </div>
                        <div class="info-messurent-item target-date">
                            <strong>Target date:</strong>{{item?.target_date | date: 'dd-MM-yyyy'}}
                        </div>
                    </div>

                </div>
                <div
                    *ngIf="initiative.type_value != 'custom' && initiative.number_result_type !=  initiative?.result.result_type_id">
                    <app-alert-status status="warning"
                        [description]="descriptionWarning(initiative?.result.name, initiative.type)"></app-alert-status>
                </div>

                <div style="margin-bottom: 10px;"
                    *ngIf="initiative.type_value == 'custom' || initiative.number_result_type ==  initiative?.result.result_type_id">
                    <app-pr-yes-or-not [label]="'Have you achieved the target of this indicator?'" [required]="true"
                        [(ngModel)]="item.indicator_question"
                        (selectOptionEvent)="item.contributing = item.indicator_question == true ? 1:0 "></app-pr-yes-or-not>
                </div>

                <div class="table-indicator">
                    <table>
                        <tr class="header"
                            *ngIf="initiative.type_value == 'custom' || initiative.number_result_type ==  initiative?.result.result_type_id">
                            <th class="row-one">Result being reported</th>
                            <th>Target contribution</th>
                        </tr>
                        <tr
                            *ngIf="initiative.type_value == 'custom' || initiative.number_result_type ==  initiative?.result.result_type_id">
                            <td><a [routerLink]="'/result/result-detail/' + initiative?.result.result_code"
                                    target="_blank"
                                    [queryParams]="{ phase: initiative?.result.version_id }">{{initiative?.result.result_code}}
                                    - {{initiative?.result.title}}</a></td>
                            <td><input type="number" class="in-progress" min="0"
                                    onkeypress="return event.charCode >= 48" [(ngModel)]="item.contributing"> out of
                                {{item.target_value}}</td>
                        </tr>
                        <tr class="header">
                            <th class="row-one">Other results contributing to the target</th>
                            <th>Target contribution</th>
                        </tr>

                        <tr *ngFor="let itemsContri of item?.results_contributing">
                            <td><a [routerLink]="'/result/result-detail/' + itemsContri?.result_code" target="_blank"
                                    [queryParams]="{ phase: initiative?.result.version_id }">{{itemsContri.result_code}}
                                    - {{itemsContri.title}}</a></td>
                            <td> {{itemsContri.contributing_indicator}} out of {{item.target_value}}</td>
                        </tr>
                        <tr *ngIf="item?.results_contributing.length == 0">
                            <td colspan="2">Currently there are no other results contributing to this target.</td>
                        </tr>
                        <tr class="footer">
                            <th class="row-one">Overall progress against planned target</th>
                            <th>{{initiative.total}} out of {{item.target_value}}</th>
                        </tr>
                    </table>
                </div>
            </div>
        
            <ng-template #contentNotNumber>
                <div class="content-not-number">
                <div class="section-one">
                    <div class="info-messurent">
                        <div class="info-messurent-item target-number">
                            <strong>Target #<span>{{sumIndicator(item.number_target)}}</span></strong>
                        </div>
                        <div class="info-messurent-item unit-messurent">
                            <strong>Unit of measure: </strong>{{initiative.unit_messurament}}
                        </div>
                        <div class="info-messurent-item overall-target">
                            <strong>Overall target:</strong> {{item.target_value}}
                        </div>
                        <div class="info-messurent-item target-date">
                            <strong>Target date: </strong>{{item?.target_date | date: 'dd-MM-yyyy'}}
                        </div>
                    </div>
                    <div class="section-two">
    
                    </div>
                </div>
                <div
                    *ngIf="initiative.number_result_type ==  initiative?.result.result_type_id || initiative.type_value == 'custom'">
                    <app-alert-status status="warning"
                        [description]="'PRMS can only identify planned targets as numerical values. If your result framework has defined a target value with a unit of measurement other than numbers, PRMS will prompt you to indicate the contribution to the quantitative indicator using a text box.'"></app-alert-status>
                </div>
    
                <div
                    *ngIf="initiative.type_value != 'custom' && initiative.number_result_type !=  initiative?.result.result_type_id">
                    <app-alert-status status="warning"
                        [description]="descriptionWarning(initiative?.result.name, initiative.type)"></app-alert-status>
                </div>
    
                <div
                    *ngIf="descriptionWarningYear(item?.target_date, initiative.result.phase_year).is_alert == false && (initiative.number_result_type ==  initiative?.result.result_type_id || initiative.type_value == 'custom')">
                    <app-alert-status status="warning"
                        [description]="descriptionWarningYear(item?.target_date, initiative.result).description"></app-alert-status>
                </div>
    
                <div style="margin-bottom: 10px;"
                    *ngIf="initiative.type_value == 'custom' || initiative.number_result_type ==  initiative?.result.result_type_id">
                    <app-pr-yes-or-not [label]="'Have you achieved the target of this indicator?'" [required]="true"
                        [(ngModel)]="item.indicator_question"
                        (selectOptionEvent)="item.contributing = item.indicator_question == true ? 1:0 "></app-pr-yes-or-not>
                </div>
    
                <div class="table-indicator">
                    <table>
                        <tr class="header"
                            *ngIf="initiative.type_value == 'custom' || initiative.number_result_type ==  initiative?.result.result_type_id">
                            <th class="row-one">Result being reported</th>
                            <th>Target contribution</th>
                        </tr>
                        <tr
                            *ngIf="initiative.type_value == 'custom' || initiative.number_result_type ==  initiative?.result.result_type_id">
                            <td><a [routerLink]="'/result/result-detail/' + initiative?.result.result_code"
                                    target="_blank"
                                    [queryParams]="{ phase: initiative?.result.version_id }">{{initiative?.result.result_code}}
                                    - {{initiative?.result.title}}</a></td>
                            <td><textarea type="text" class="input-not-calculable"
                                    [(ngModel)]="item.contributing">{{item.contributing}} </textarea></td>
                        </tr>
                        <tr class="header">
                            <th class="row-one">Other results contributing to the target</th>
                            <th>Target contribution</th>
                        </tr>
                        <tr *ngIf="item?.results_contributing.length == 0">
                            <td colspan="2">Currently there are no other results contributing to this target.
                            </td>
                        </tr>
                        <tr *ngFor="let itemsContri of item?.results_contributing">
                            <td><a [routerLink]="'/result/result-detail/' + itemsContri?.result_code" target="_blank"
                                    [queryParams]="{ phase: initiative?.result.version_id }">{{itemsContri.result_code}}
                                    - {{itemsContri.title}}</a></td>
                            <td> {{itemsContri.contributing_indicator}}</td>
                        </tr>
                    </table>
                </div>
                </div>
            </ng-template>
        </div>
    </div>

    <div class="header-footer">
    </div>

</div>