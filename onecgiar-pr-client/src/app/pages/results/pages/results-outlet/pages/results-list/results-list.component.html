<div class="local_container">
  <app-report-new-result-button>
  </app-report-new-result-button>
  <div class="alert"></div>
  <app-results-list-filters></app-results-list-filters>
</div>
<div class="table">
  <p-table sortField="id" [sortOrder]="1"
    [value]="(this.api.dataControlSE.resultsList | resultsListFilter:this.resultsListService.text_to_search:this.api.resultsListFilterSE.filterJoin)"
    responsiveLayout="scroll"
    [paginator]="(this.api.dataControlSE.resultsList | resultsListFilter:this.resultsListService.text_to_search:this.api.resultsListFilterSE.filterJoin)?.length"
    [rows]="10" styleClass="p-datatable-gridlines p-datatable-sm" selectionMode="single">
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="{{column.attr}}" *ngFor="let column of columnOrder">
          <p-sortIcon field="{{column.attr}}"></p-sortIcon>{{column.title}}
        </th>
        <th>Action</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-result>
      <tr>
        <td *ngFor="let column of columnOrder; let i=index" class="{{column.attr}}">
          <a class="{{column.class}}" [routerLink]="'/result/result-detail/' + result[column.attr]">
            <div class="point" [style.background]="'var(--pr-color-result-level-'+result?.result_level_id+')'"
              *ngIf="column.attr === 'result_type'"></div>

            <div class="new_tag" *ngIf="i==1 && result.is_new">New</div> {{column.attr !== 'created_date' ?
            result[column.attr] : (result[column.attr] | date: 'YYYY-MM-dd')}}
          </a>
          <div class="transparent_text">
            {{ result[column.attr] }}
          </div>
        </td>
        <td>
          <div class="icon_container"><i class="pi pi-ellipsis-v" (click)="menu.toggle($event)"></i></div>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <div class="total" *ngIf="(this.api.dataControlSE.resultsList |
  resultsListFilter:this.resultsListService.text_to_search:this.api.resultsListFilterSE.filterJoin)?.length">Total:
    {{(this.api.dataControlSE.resultsList |
    resultsListFilter:this.resultsListService.text_to_search:this.api.resultsListFilterSE.filterJoin)?.length}}</div>
</div>

<div class="noDataText"
  *ngIf="!(this.api.dataControlSE.resultsList | resultsListFilter:this.resultsListService.text_to_search:this.api.resultsListFilterSE.filterJoin)?.length">
  There are no results for the selected filters.
</div>

<p-menu #menu [popup]="true" [model]="items"></p-menu>