<div class="local_container">
    <app-pr-multi-select label="Initiatives" selectedLabel="Initiatives selected"
        [options]="this.api.dataControlSE.myInitiativesList | filterInitWithRoleCoordAndLead" optionLabel="full_name"
        [isStatic]="true" optionValue="id" (selectOptionEvent)="onSelectInit()" [required]="false"
        (removeOptionEvent)="onRemoveinit($event)" selectedOptionLabel="full_name"
        [(ngModel)]="this.initiativesSelected" placeholder="Select initiative(s)">
    </app-pr-multi-select>
    <br>

    <!-- <div class="table_container"> -->


    <app-pr-multi-select
        [options]="this.resultsList | filterByAttrWithValue:'is_submitted':valueToFilter |  filterByAttrWithValue:'year':yearToFilter"
        label="Results" [isStatic]="true" *ngIf="this.resultsList?.length" optionLabel="full_name_html" optionValue="id"
        [showSelectAll]="true" [required]="false" selectedOptionLabel="full_name" [(ngModel)]="this.resultsSelected"
        itemSize="15" placeholder="Select result(s)
        ">
        <div class="filter_submission_buttons" util>
            <div class="option all" [ngClass]="{'active': this.valueToFilter == null}"
                (click)="this.valueToFilter = null">All</div>
            <div class="option submitted" [ngClass]="{'active': this.valueToFilter == 1}"
                (click)="this.valueToFilter = 1">submitted</div>
            <div class="option editing" [ngClass]="{'active': this.valueToFilter == 0}"
                (click)="this.valueToFilter = 0">Editable</div>
            <!-- <div class="option year" [ngClass]="{'active': this.yearToFilter == 2022}"
                (click)="this.yearToFilter == 2022 ? this.yearToFilter = null : this.yearToFilter = 2022">
                2022</div>
            <div class="option year" [ngClass]="{'active': this.yearToFilter == 2023}"
                (click)="this.yearToFilter == 2023 ? this.yearToFilter = null : this.yearToFilter = 2023">
                2023</div> -->
        </div>
    </app-pr-multi-select>

    <div class="alert_status_container" *ngIf="resultsSelected?.length">
        <div [ngClass]="{'animate__pulse_infinite': this.requesting}">
            <app-alert-status
                [description]="this.requesting ?'The report may take some time to be generated, please do not close the window.':'This report consumes a considerable amount of system resources, therefore, we appreciate it if you do not generate reports too often.'">
            </app-alert-status>
        </div>

    </div>



    <div class="results_selected">
        <div class="title">
            <div>Results selected ({{resultsSelected?.length}}): </div>
            <div class="download_button_container">
                <app-pr-button icon="file_download" *ngIf="resultsSelected?.length"
                    [ngClass]="{'globalDisabled': this.requesting}"
                    [text]="this.requesting?'Downloading .xlsx - results '+requestCounter+'/'+(resultsSelected.length):'Download .xlsx'"
                    [rotating]="this.requesting" [icon]="this.requesting?'loop':'send'"
                    (click)="exportExcel(this.resultsSelected)"></app-pr-button>
            </div>
        </div>
        <div class="results">
            <div class="result" *ngFor="let result of resultsSelected; let i=index">
                <div class="index">{{i+1}}</div>
                <div [innerHTML]="result.full_name_html"></div>
            </div>
        </div>

    </div>
    <br>




    <!-- <p-table [value]="this.resultsList | filterByText:this.textToFind" [scrollable]="true" [paginator]="true"
            [rowsPerPageOptions]="[10,50,100]" [rows]="10" scrollHeight="calc(100vh - 403px)" style="min-width: 200px">
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="result_code" style="min-width:200px">Result code <p-sortIcon
                            field="result_code"></p-sortIcon>
                    </th>
                    <th pSortableColumn="result_title" style="min-width:500px">Title <p-sortIcon
                            field="result_title"></p-sortIcon></th>
                    <th pSortableColumn="official_code" style="min-width:150px">Submitter <p-sortIcon
                            field="official_code"></p-sortIcon>
                    </th>
                    <th pSortableColumn="result_type_name" style="min-width:180px">Result type <p-sortIcon
                            field="result_type_name"></p-sortIcon>
                    </th>
                    <th pSortableColumn="completeness" style="min-width:150px">Progress <p-sortIcon
                            field="completeness"></p-sortIcon>
                    </th>
                    <th pSortableColumn="is_submitted" style="min-width:150px">Submitted <p-sortIcon
                            field="is_submitted"></p-sortIcon>
                    </th>
                    <th pSortableColumn="is_submitted" style="min-width:150px">Action <p-sortIcon
                        field="is_submitted"></p-sortIcon>
                </th>

                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-result>
                <tr>
                    <td style="min-width:200px">{{result.result_code}}</td>
                    <td style="min-width:500px">{{result.result_title}}</td>
                    <td style="min-width:150px">{{result.official_code}}</td>
                    <td style="min-width:180px">{{result.result_type_name}}</td>
                    <td style="min-width:150px">{{result.completeness}}%</td>
                    <td style="min-width:150px">{{result.is_submitted ?'Yes':'No'}}</td>
                    <div style="z-index: 0" *ngIf="result.is_submitted">
                        <app-pr-button [ngClass]="{'globalDisabled': !result.is_submitted}" text="See more"
                            (click)="selectResults(result?.results_id)"></app-pr-button>
                    </div>

                </tr>
            </ng-template>
        </p-table> -->
    <!-- <div class="counter">
            <div class="name">Results: </div> {{(this.resultsList |
            filterByText:this.textToFind).length}}/{{this.resultsList?.length}}
        </div> -->
    <!-- </div> -->

</div>